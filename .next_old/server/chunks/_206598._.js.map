{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/utils/database.js"],"sourcesContent":["// import mongoose from 'mongoose';\n\n// const MONGODB_URI = process.env.MONGODB_URI;\n\n// if (!MONGODB_URI) {\n//   throw new Error(\n//     'Please define the MONGODB_URI environment variable inside .env.local'\n//   );\n// }\n\n// let cached = global.mongoose;\n\n// if (!cached) {\n//   cached = global.mongoose = { conn: null, promise: null };\n// }\n\n// const connectToDatabase = async () => {\n//   if (cached.conn) {\n//     return cached.conn;\n//   }\n\n//   if (!cached.promise) {\n//     const opts = {\n//       dbName: 'georef'\n//     };\n\n//     cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n//       return mongoose;\n//     });\n//   }\n//   cached.conn = await cached.promise;\n//   return cached.conn;\n// }\n\n// export default connectToDatabase;\n\nimport mongoose from 'mongoose';\n\n//let connection = null;\n\nlet cached = global.mongoose;\n\nif (!cached) {\n  cached = global.mongoose = { conn: null, promise: null };\n}\n\nconst connectToDatabase = async () => {\n    mongoose.set('strictQuery', true);\n    //mongoose.set('timestamps', true);\n\n    if (cached.conn) {\n      return cached.conn;\n    }\n  \n    if (!cached.promise) {\n      const opts = {\n        bufferCommands: false,\n      };\n  \n      cached.promise = mongoose.connect(process.env.MONGODB_URI, {\n                dbName: 'georef'\n            }).then((mongoose) => {\n        return mongoose;\n      });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n\n    // try {\n    //     connection = await mongoose.createConnection(process.env.MONGODB_URI, {\n    //         dbName: 'georef'\n    //     }).asPromise();\n\n    //     if (connection.readyState == 1) {\n    //       console.log('db connection established!');\n    //       return connection;\n    //     }\n    //     return null;\n    // } catch (error) {\n    //     console.log(error);\n    // }\n}\n\nexport default connectToDatabase;"],"names":[],"mappings":"AAAA,mCAAmC;AAEnC,+CAA+C;AAE/C,sBAAsB;AACtB,qBAAqB;AACrB,6EAA6E;AAC7E,OAAO;AACP,IAAI;AAEJ,gCAAgC;AAEhC,iBAAiB;AACjB,8DAA8D;AAC9D,IAAI;AAEJ,0CAA0C;AAC1C,uBAAuB;AACvB,0BAA0B;AAC1B,MAAM;AAEN,2BAA2B;AAC3B,qBAAqB;AACrB,yBAAyB;AACzB,SAAS;AAET,gFAAgF;AAChF,yBAAyB;AACzB,UAAU;AACV,MAAM;AACN,wCAAwC;AACxC,wBAAwB;AACxB,IAAI;AAEJ,oCAAoC;;;;;;;AAIpC,wBAAwB;AAExB,IAAI,SAAS,OAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACX,SAAS,OAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,MAAM,oBAAoB;IACtB,2CAAA,CAAA,UAAQ,CAAC,GAAG,CAAC,eAAe;IAC5B,mCAAmC;IAEnC,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,2CAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;YACjD,QAAQ;QACZ,GAAG,IAAI,CAAC,CAAC;YACb,OAAO;QACT;IACF;IACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AAElB,QAAQ;AACR,8EAA8E;AAC9E,2BAA2B;AAC3B,sBAAsB;AAEtB,wCAAwC;AACxC,mDAAmD;AACnD,2BAA2B;AAC3B,QAAQ;AACR,mBAAmB;AACnB,oBAAoB;AACpB,0BAA0B;AAC1B,IAAI;AACR;uCAEe"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/utils/enums.jsx"],"sourcesContent":["export const MapStatus = {\n    New: 'new',\n    Tiling: 'tiling',\n    TilingDone: 'tilingDone',\n    ErrorWhileTiling: 'errorWhileTiling',\n    SyncingWithStorage: 'syncingWithStorage',\n    Synced: 'synced',\n    Uploading: 'uploading',\n    Ready: 'ready'\n}\n\nexport const CurrentControlPointStatus = {\n    FromPointSelected: 'fromPointSelected',\n    ToPointSelected: 'toPointSelected',\n    FreeForSelection: 'freeForSelection',\n    ReadyForSaving: 'readyForSaving',\n    EditExisting: 'editExisting'\n}\n\nexport const ControlPointSelection = {\n    From: 'from',\n    To: 'to',\n    Both: 'both'\n}\n\nexport const TransformationType = {\n    Polynomial: 'polynomial',\n    Polynomial2: 'polynomial2',\n    Polynomial3: 'polynomial3',\n    ThinPlateSpline: 'thinPlateSpline',\n    Projective: 'projective'\n}\n\nexport const TransformationTypes = [\n    TransformationType.Polynomial,\n    TransformationType.Polynomial2,\n    TransformationType.Polynomial3,\n    TransformationType.ThinPlateSpline,\n    TransformationType.Projective\n]\n\nexport const TransformationTypeLabels = {\n    'polynomial' : '1st order Polynomial',\n    'polynomial2' : '2nd order Polynomial',\n    'polynomial3' : '3rd order Polynomial',\n    'thinPlateSpline' : 'Thin plate spline',\n    'projective' : 'Projective'\n}\n\nexport const TransformationTypesMinGCP = {\n    'polynomial' : 3,\n    'polynomial2' : 6,\n    'polynomial3' : 10,\n    'thinPlateSpline' : 3,\n    'projective' : 4\n}"],"names":[],"mappings":";;;;;;;;;AAAO,MAAM,YAAY;IACrB,KAAK;IACL,QAAQ;IACR,YAAY;IACZ,kBAAkB;IAClB,oBAAoB;IACpB,QAAQ;IACR,WAAW;IACX,OAAO;AACX;AAEO,MAAM,4BAA4B;IACrC,mBAAmB;IACnB,iBAAiB;IACjB,kBAAkB;IAClB,gBAAgB;IAChB,cAAc;AAClB;AAEO,MAAM,wBAAwB;IACjC,MAAM;IACN,IAAI;IACJ,MAAM;AACV;AAEO,MAAM,qBAAqB;IAC9B,YAAY;IACZ,aAAa;IACb,aAAa;IACb,iBAAiB;IACjB,YAAY;AAChB;AAEO,MAAM,sBAAsB;IAC/B,mBAAmB,UAAU;IAC7B,mBAAmB,WAAW;IAC9B,mBAAmB,WAAW;IAC9B,mBAAmB,eAAe;IAClC,mBAAmB,UAAU;CAChC;AAEM,MAAM,2BAA2B;IACpC,cAAe;IACf,eAAgB;IAChB,eAAgB;IAChB,mBAAoB;IACpB,cAAe;AACnB;AAEO,MAAM,4BAA4B;IACrC,cAAe;IACf,eAAgB;IAChB,eAAgB;IAChB,mBAAoB;IACpB,cAAe;AACnB"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 147, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/models/map.js"],"sourcesContent":["import { Schema, model, models } from 'mongoose';\nimport { MapStatus } from '@utils/enums';\n\nconst ControlPointSchema = new Schema({\n    fromPoint: {\n        type: [Number],\n        required: [true, 'fromPoint (virtual lat and long) is required.']\n    },\n    toPoint: {\n        type: [Number],\n        required: [true, 'toPoint (long and lat within OSM) is required.']\n    },\n    rasterImageCoords: {\n        type: [Number],\n        required: [true, 'rasterImageCoords (x, y coords of raster image) is required.']\n    }\n}, { timestamps: true, })\n\nControlPointSchema.pre('save', (next) => {\n    console.log('pre save for control point : ' + this)\n    next();\n})\n\n// export const ControlPoint = models.ControlPoint || model('ControlPoint', ControlPointSchema)\n\nconst MapSchema = new Schema({\n    user: {\n        type: Schema.Types.ObjectId,\n        ref: \"User\"\n    },\n    title: {\n        type: String,\n        required: [true, 'title is required.']\n    },\n    status: {\n        type: String,\n        default: MapStatus.New\n    },\n    fileId: {\n        type: String\n    },\n    width: {\n        type: Number\n    },\n    height: {\n        type: Number\n    },\n    maxZoomLevel: {\n        type: Number,\n        default: 5\n    },\n    controlPoints: [ControlPointSchema],\n}, { timestamps: true, })\n\nconst Map = models.Map || model(\"Map\", MapSchema);\n\nexport default Map;"],"names":[],"mappings":";;;;;;;;AAGA,MAAM,qBAAqB,IAAI,2CAAA,CAAA,SAAM,CAAC;IAClC,WAAW;QACP,MAAM;YAAC;SAAO;QACd,UAAU;YAAC;YAAM;SAAgD;IACrE;IACA,SAAS;QACL,MAAM;YAAC;SAAO;QACd,UAAU;YAAC;YAAM;SAAiD;IACtE;IACA,mBAAmB;QACf,MAAM;YAAC;SAAO;QACd,UAAU;YAAC;YAAM;SAA+D;IACpF;AACJ,GAAG;IAAE,YAAY;AAAM;AAEvB,mBAAmB,GAAG,CAAC,QAAQ,CAAC;IAC5B,QAAQ,GAAG,CAAC,kCAAkC,IAAI;IAClD;AACJ;AAEA,+FAA+F;AAE/F,MAAM,YAAY,IAAI,2CAAA,CAAA,SAAM,CAAC;IACzB,MAAM;QACF,MAAM,2CAAA,CAAA,SAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;IACT;IACA,OAAO;QACH,MAAM;QACN,UAAU;YAAC;YAAM;SAAqB;IAC1C;IACA,QAAQ;QACJ,MAAM;QACN,SAAS,iHAAA,CAAA,YAAS,CAAC,GAAG;IAC1B;IACA,QAAQ;QACJ,MAAM;IACV;IACA,OAAO;QACH,MAAM;IACV;IACA,QAAQ;QACJ,MAAM;IACV;IACA,cAAc;QACV,MAAM;QACN,SAAS;IACb;IACA,eAAe;QAAC;KAAmB;AACvC,GAAG;IAAE,YAAY;AAAM;AAEvB,MAAM,MAAM,2CAAA,CAAA,SAAM,CAAC,GAAG,IAAI,CAAA,GAAA,2CAAA,CAAA,QAAK,AAAD,EAAE,OAAO;uCAExB"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/api/map/route.js"],"sourcesContent":["import connectToDatabase  from '@utils/database';\nimport Map from \"@models/map\";\n// import { URLSearchParams } from 'next/dist/compiled/@edge-runtime/primitives/url';\n\nimport { MapStatus } from '@utils/enums';\n\nexport const dynamic = 'force-dynamic';\n\nexport const GET = async (req) => {\n    try {\n        // const url = new URL(req.url);\n        // const searchParams = new URLSearchParams(url.searchParams);\n        // console.log('searchParams', searchParams);\n\n        const searchParams = req.nextUrl.searchParams;\n\n        await connectToDatabase();\n\n        if (searchParams.get('selectedMap') !== null) {\n            const selectedMapSearchParam = searchParams.get('selectedMap');\n\n            console.log('selected map query : ' + selectedMapSearchParam);\n\n            let newest = selectedMapSearchParam === 'newest';\n            const selectedMap = await Map.aggregate()\n                                    .sort({ createdAt : newest ? 1 : -1 })\n                                    .limit(1)\n                                    .exec();\n\n            console.log('selected map result : ' + JSON.stringify(selectedMap));\n\n            return new Response(JSON.stringify(selectedMap, { status : 200 }));\n        }\n        else {\n            const maps = await Map.find({}).populate('user');\n            return new Response(JSON.stringify(maps, { status : 200 }));\n        }\n        \n    } catch (error) {\n        console.log(error);\n        return new Response(\"Failed to retrieve maps.\", { status: 500 });\n    }\n}"],"names":[],"mappings":";;;;;;;;;;;AAMO,MAAM,UAAU;AAEhB,MAAM,MAAM,OAAO;IACtB,IAAI;QACA,gCAAgC;QAChC,8DAA8D;QAC9D,6CAA6C;QAE7C,MAAM,eAAe,IAAI,OAAO,CAAC,YAAY;QAE7C,MAAM,CAAA,GAAA,mHAAA,CAAA,UAAiB,AAAD;QAEtB,IAAI,aAAa,GAAG,CAAC,mBAAmB,MAAM;YAC1C,MAAM,yBAAyB,aAAa,GAAG,CAAC;YAEhD,QAAQ,GAAG,CAAC,0BAA0B;YAEtC,IAAI,SAAS,2BAA2B;YACxC,MAAM,cAAc,MAAM,+GAAA,CAAA,UAAG,CAAC,SAAS,GACd,IAAI,CAAC;gBAAE,WAAY,SAAS,IAAI,CAAC;YAAE,GACnC,KAAK,CAAC,GACN,IAAI;YAE7B,QAAQ,GAAG,CAAC,2BAA2B,KAAK,SAAS,CAAC;YAEtD,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC,aAAa;gBAAE,QAAS;YAAI;QACnE,OACK;YACD,MAAM,OAAO,MAAM,+GAAA,CAAA,UAAG,CAAC,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC;YACzC,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC,MAAM;gBAAE,QAAS;YAAI;QAC5D;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,GAAG,CAAC;QACZ,OAAO,IAAI,SAAS,4BAA4B;YAAE,QAAQ;QAAI;IAClE;AACJ"}},
    {"offset": {"line": 276, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}